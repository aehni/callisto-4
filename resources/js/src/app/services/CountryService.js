module.exports = (function($)
{

    return {
        parseShippingCountries: parseShippingCountries,
        parseShippingStates   : parseShippingStates,
        translateCountryNames : translateCountryNames,
        sortCountries         : sortCountries
    };

    function parseShippingCountries(countryData, id)
    {
        var countryList = JSON.parse(countryData);
        var deliveryCountries = [];

        if (countryList == null)
        {
            return deliveryCountries;
        }

        for (var key in countryList)
        {
            var country = countryList[key];
            var option = {
                id      : country.id,
                name    : country.name,
                locale  : country.isoCode2,
                selected: false
            };

            option.selected = (id === country.id);
            deliveryCountries.push(option);
        }

        return deliveryCountries;
    }

    function translateCountryNames(countryNameData, countries)
    {
        var countryNames = JSON.parse(countryNameData);

        if (countryNames == null)
        {
            return;
        }
        for (var id in countryNames)
        {
            var name = countryNames[id];

            for (var i = 0, len = countries.length; i < len; i++)
            {
                var country = countries[i];

                if (country.id == id)
                {
                    country.name = name;
                    break;
                }
            }
        }
    }

    function sortCountries(countries)
    {
        countries.sort(function(a, b)
        {
            if (a.name < b.name)
            {
                return -1;
            }
            if (a.name > b.name)
            {
                return 1;
            }
            return 0;
        });
    }

    function parseShippingStates(countryData, countryID)
    {

        var states = [];
        var countryList = JSON.parse(countryData);

        for (var key in countryList)
        {
            var country = countryList[key];

            if (country.id == countryID)
            {
                states = country.states;
                break;
            }
        }

        return states;
    }

})(jQuery);
